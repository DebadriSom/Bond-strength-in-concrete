library (neuralnet)
normalize <- function(x) {
  return ((x - min(x)) / (max(x) - min(x)))
}
maxmindf <- as.data.frame(lapply(NN, normalize))

# TRAINING AND TEST DATA
trainset <- maxmindf[1:70, ]
testset <- maxmindf[71:94, ]
#4. NEURAL NETWORK
library(neuralnet)
nn <- neuralnet(Slant ~ roughness + str_sub + str_over + diff_E, data=trainset, hidden=c(3,2), linear.output=FALSE, act.fct = 'tanh', err.fct = 'sse')
nn$result.matrix
plot (nn)
results <- data.frame(actual = testset$Slant, prediction = compute(nn,testset)$net.result)
results
predicted=results$prediction * abs(diff(range(NN$Slant))) + min(NN$Slant)
actual=results$actual * abs(diff(range(NN$Slant))) + min(NN$Slant)
comparison=data.frame(predicted,actual)
deviation=((actual-predicted)/actual)
comparison=data.frame(predicted,actual,deviation)
accuracy=1-abs(mean(deviation))
accuracy
write.table(comparison, file="data_comp.csv", sep=" , ")
